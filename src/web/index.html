<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Export To Ghostfolio</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üìä</text></svg>">
    <link rel="stylesheet" href="/styles.css">
</head>
<body>
    <h1 id="appTitle">üìä Export To Ghostfolio</h1>
    <p class="subtitle">Convert your broker CSV export to Ghostfolio format</p>

    <div class="card">
        <form id="convertForm">
            <label for="accountId">Ghostfolio Account ID</label>
            <div class="input-group">
                <input
                    type="hidden"
                    id="accountId"
                    name="accountId"
                    required
                >
                <div class="account-display empty" id="accountDisplay" contenteditable="true" data-placeholder="Type or paste UUID, or click to select from history"></div>
                <button type="button" class="paste-btn" id="accountPasteBtn" title="Paste from clipboard">üìã</button>
                <div class="history-dropdown" id="accountHistoryDropdown"></div>
            </div>

            <label for="tagIds">Tag IDs (optional)</label>
            <div class="input-group">
                <input
                    type="hidden"
                    id="tagIds"
                    name="tagIds"
                >
                <div class="tags-display empty" id="tagsDisplay" contenteditable="true" data-placeholder="Type or paste UUIDs (comma-separated), or click to select from history"></div>
                <button type="button" class="paste-btn" id="tagPasteBtn" title="Paste from clipboard">üìã</button>
                <div class="history-dropdown" id="tagHistoryDropdown"></div>
            </div>

            <label>CSV Export File</label>
            <div class="file-upload" id="dropZone">
                <input type="file" id="fileInput" accept=".csv" required>
                <div class="file-upload-icon">üìÅ</div>
                <div class="file-upload-text">
                    <span id="fileLabel">Drop your CSV file here or click to browse</span>
                </div>
            </div>

            <button type="submit" id="submitBtn">Convert to Ghostfolio JSON</button>
        </form>

        <div class="status" id="status"></div>
    </div>

    <div class="help">
        <strong>Supported brokers:</strong> Trading212, DEGIRO, Schwab, IBKR, Swissquote, Coinbase, eToro, Revolut, and many more.
        The file format is auto-detected from the CSV header.
        <br><br>
        Find your Account ID in Ghostfolio under <strong>Settings ‚Üí Accounts</strong>.
        <br>
        Find your Tag IDs in Ghostfolio under <strong>Settings ‚Üí Tags</strong> (click a tag to see its UUID in the URL).
    </div>

    <div class="actions-row">
        <button type="button" id="exportBackupBtn">Export IDs backup</button>
        <input type="file" id="importBackupInput" accept="application/json,.json" />
        <button type="button" id="importBackupBtn">Import backup</button>
    </div>

    <!-- Alias edit modal -->
    <div class="modal-overlay" id="aliasModalOverlay" role="dialog" aria-modal="true" aria-hidden="true">
        <div class="modal">
            <h3 id="aliasModalTitle">Edit alias</h3>
            <div style="font-size: 12px; color: #666; margin-bottom: 12px; font-family: monospace;" id="aliasModalId"></div>
            <label for="aliasModalInput" style="position:absolute;left:-10000px;top:auto;width:1px;height:1px;overflow:hidden;">Alias</label>
            <input type="text" id="aliasModalInput" placeholder="e.g. IBKR Main Account" />
            <div class="modal-actions">
                <button type="button" class="cancel-btn" id="aliasModalCancel">Cancel</button>
                <button type="button" id="aliasModalSave">Save</button>
            </div>
        </div>
    </div>

    <script src="/scripts.js"></script>
</body>
</html>

